# HS1101 Breath Rate Measurement System

## 简介
该系统通过 HS1101 湿度传感器实时检测呼吸波形，并利用上位机程序显示呼吸频率、波形变化曲线和历史数据。此外，系统能够对异常呼吸频率进行语音报警提示。

## 功能列表
- **实时波形显示**：实时更新呼吸波形曲线，便于观测呼吸变化。
- **历史波形查看**：可切换至历史波形模式，显示过去的呼吸数据。
- **波形变化曲线**：显示呼吸波形变化量，辅助分析呼吸动态。
- **呼吸频率计算**：基于波形变化检测呼吸频率。
- **异常报警功能**：当呼吸频率不在正常范围内（12-20次/分钟）时，发出语音报警。
- **数据导出**：支持将数据保存为CSV文件。
- **多视图切换**：支持实时波形、历史波形、频率分布和变化曲线四种视图模式。

## 使用说明

### 硬件连接
1. 确保 HS1101 传感器连接至相应的硬件电路，并通过串口连接至计算机。
2. 确保传感器采样频率和电路放大器设置正确。

### 软件运行
1. 安装必要的依赖库：
   ```bash
   pip install pyqt5 matplotlib playsound pyserial
   ```
2. 确保代码目录下存在报警音频文件 `alarm.mp3`。
3. 运行程序：
   ```bash
   python main.py
   ```

### 系统界面操作
1. **选择串口**：
   - 在窗口顶部的串口选择下拉菜单中选择正确的串口。
2. **查看实时波形**：
   - 系统默认显示实时波形。
   - 波形下方会实时显示当前频率和呼吸频率。
3. **切换视图模式**：
   - 在“视图选择”下拉菜单中选择不同视图：
     - 实时波形
     - 历史波形
     - 频率分布
     - 波形变化曲线
4. **数据导出**：
   - 点击“保存数据”按钮，将呼吸数据导出为CSV文件。
5. **异常报警**：
   - 如果呼吸频率低于12或高于20次/分钟，系统会自动发出语音报警。

### 参数设置
- **呼吸频率范围**：正常范围为12-20次/分钟，可在代码中修改：
  ```python
  MIN_BREATHING_RATE = 12
  MAX_BREATHING_RATE = 20
  ```
- **波形窗口大小**：
  ```python
  WINDOW_SIZE = 200
  ```

## 常见问题

### 程序无法连接到串口
- 检查传感器是否正确连接。
- 确保所选串口与设备一致。
- 如果仍有问题，尝试重新启动程序或更换USB接口。

### 报警声音无法播放
- 确保目录下存在 `alarm.mp3` 文件。
- 检查音频驱动是否正常。

### 波形更新延迟
- 确保硬件电路工作正常，传感器响应速度符合要求。
- 检查串口波特率是否设置为115200或更高。
- 优化硬件采样频率和软件绘图频率。

## 文件结构
```
.
├── main.py          # 主程序代码
├── alarm.mp3        # 报警音频文件
└── README.md        # 使用说明文件
```

## 版本信息
- **版本**：v1.6
- **更新日期**：2024-12-23

## 开发人员
- **开发者**：Quartz
- **联系方式**：SYRQuartz@gmail.com
